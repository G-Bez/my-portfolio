{
  "hash": "56a8f505c6bb7e6c9ea686b9a11bc964",
  "result": {
    "markdown": "---\ntitle: \"Animated plots in R with gganimate package\"\ndate: \"2022-11-19\"\ncategories: [R, Visualization]\nimage: gganimate_thumbnail.png\nformat:\n  html:\n    code-tools: true\n    df-print: paged\n    fontsize: 0.9em\n    include-in-header: navbar.html\n    css: theme.css\n    toc: true\ncomments: \n    utterances: \n      repo:  G-Bez/my-portfolio \n      theme: photon-dark\ntitle-block-banner: false\neditor: visual\n---\n\n::: {.cell}\n<style type=\"text/css\">\n.justify {\n  text-align: justify !important\n}\n</style>\n:::\n\n\n::: justify\nIf you ever thought static plots to be a bit bland or not enough powerful to represent all the nuances of your data, then `gganimate` package is what you need to further improve your visualizations. `gganimate` extends the grammar of graphics as implemented by ggplot2 to include the description of animation. It does this by providing a range of new grammar classes that can be added to the plot object in order to customise how it should change with time.\n\n-   `transition_*()` defines how the data should be spread out and how it relates to itself across time.\n-   `view_*()` defines how the positional scales should change along the animation.\n-   `shadow_*()` defines how data from other points in time should be presented in the given point in time.\n-   `enter_*()`/`exit_*()` defines how new data should appear and how old data should disappear during the course of the animation.\n-   `ease_aes()` defines how different aesthetics should be eased during transitions.\n:::\n\n# Install gganimate\n\n::: justify\nYou can install `gganimate` from CRAN repository with:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"gganimate\")\n```\n:::\n\n\nOr the the developer version from GitHub with:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::install_github('thomasp85/gganimate')\n```\n:::\n\n:::\n\n# Packages\n\n::: justify\nWe start by loading the needed packages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(reshape2)\nlibrary(ggplot2)\nlibrary(gganimate)\nlibrary(gifski)\n```\n:::\n\n\n::: callout-note\n## Note:\n\nBy default, `gganimate` writes each animation frame to separate image files. and stops there. You can produce gif outputs by installing `gifski` package, or video outputs with `av` package. If installed, `gganimate` will automatically detect the rendering backend, but you can also manually choose the rendering method by setting the `renderer` parameter of `gganimate::animate()` to the desired value. See `?gganimate::animate()` for more details.\n:::\n\nBefore proceding, I'll explain some key concepts of animated data visualization.\n:::\n\n# Tweening\n\n::: justify\nAnimation has always been about the illusion of movement. Tweening is a major part of making that illusion look real. **Tweening** in animation is a short for inbetweening, and it's the process of generating images that go between keyframes. Keyframes are the images at the beginning and end of a smooth transition.\n\nIn the context of data visualization, tweening is the process of splitting data into subsets based on a variable in the data, and calculating intermediary data states that ensures a smooth transition between the states. `gganimate` provides a wide range of different transitions, for different datatypes, defined by `transition_*()` functions. We'll see some examples later.\n:::\n\n# Easing\n\n::: justify\nIn the context of animation, **easing** lends a natural, organic movement to motion. A linear animation (one built without easing) will move mechanically without slowing down or speeding up. As this kind of consistency in speed doesn't occur in nature, we perceive the movement as unnatural. Objects in real life don't start moving and maintaining the same speed throughout. They start slowly, pick up speed and slow down as they come to a halt.Â That's why `gganimate` supports the easing of animations with `ease_aes()` function.\n\nThere are plenty of different easing methods, defined by an **easing function** and by an **easing modifier**. For a list of available easing functions, see `?tweenr::display_ease` (`tweenr` package is a dependency of `gganimate`). Below I explain the 3 different modifiers.\n\n-   **In**: applies the easing function as-is.\n-   **Out**: applies the easing function in reverse.\n-   **In-Out**: the first half of the transition is applied as-is, while the last half is applied in reverse.\n\nFor a visual representation of all the combinations of easing functions and modifiers, see [easing.net](https://easings.net/) webpage. We'll see some examples later.\n:::\n\n# Labeling\n\n::: justify\nIt can be quite hard to understand an animation without any indication as to what each point relates to. `gganimate` solves this by providing a set of variables for each frame, which can be inserted into plot labels using [`glue`](https://glue.tidyverse.org) syntax.\n:::\n\n# Example 1: mtcars dataset\n\n::: justify\nNow we're ready for some actual animations. We start with the R prebuilt `mtcars` dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatasets::mtcars\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"mpg\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"cyl\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"disp\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"hp\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"drat\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"wt\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"qsec\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"vs\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"am\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"gear\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"carb\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"21.0\",\"2\":\"6\",\"3\":\"160.0\",\"4\":\"110\",\"5\":\"3.90\",\"6\":\"2.620\",\"7\":\"16.46\",\"8\":\"0\",\"9\":\"1\",\"10\":\"4\",\"11\":\"4\",\"_rn_\":\"Mazda RX4\"},{\"1\":\"21.0\",\"2\":\"6\",\"3\":\"160.0\",\"4\":\"110\",\"5\":\"3.90\",\"6\":\"2.875\",\"7\":\"17.02\",\"8\":\"0\",\"9\":\"1\",\"10\":\"4\",\"11\":\"4\",\"_rn_\":\"Mazda RX4 Wag\"},{\"1\":\"22.8\",\"2\":\"4\",\"3\":\"108.0\",\"4\":\"93\",\"5\":\"3.85\",\"6\":\"2.320\",\"7\":\"18.61\",\"8\":\"1\",\"9\":\"1\",\"10\":\"4\",\"11\":\"1\",\"_rn_\":\"Datsun 710\"},{\"1\":\"21.4\",\"2\":\"6\",\"3\":\"258.0\",\"4\":\"110\",\"5\":\"3.08\",\"6\":\"3.215\",\"7\":\"19.44\",\"8\":\"1\",\"9\":\"0\",\"10\":\"3\",\"11\":\"1\",\"_rn_\":\"Hornet 4 Drive\"},{\"1\":\"18.7\",\"2\":\"8\",\"3\":\"360.0\",\"4\":\"175\",\"5\":\"3.15\",\"6\":\"3.440\",\"7\":\"17.02\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"2\",\"_rn_\":\"Hornet Sportabout\"},{\"1\":\"18.1\",\"2\":\"6\",\"3\":\"225.0\",\"4\":\"105\",\"5\":\"2.76\",\"6\":\"3.460\",\"7\":\"20.22\",\"8\":\"1\",\"9\":\"0\",\"10\":\"3\",\"11\":\"1\",\"_rn_\":\"Valiant\"},{\"1\":\"14.3\",\"2\":\"8\",\"3\":\"360.0\",\"4\":\"245\",\"5\":\"3.21\",\"6\":\"3.570\",\"7\":\"15.84\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"4\",\"_rn_\":\"Duster 360\"},{\"1\":\"24.4\",\"2\":\"4\",\"3\":\"146.7\",\"4\":\"62\",\"5\":\"3.69\",\"6\":\"3.190\",\"7\":\"20.00\",\"8\":\"1\",\"9\":\"0\",\"10\":\"4\",\"11\":\"2\",\"_rn_\":\"Merc 240D\"},{\"1\":\"22.8\",\"2\":\"4\",\"3\":\"140.8\",\"4\":\"95\",\"5\":\"3.92\",\"6\":\"3.150\",\"7\":\"22.90\",\"8\":\"1\",\"9\":\"0\",\"10\":\"4\",\"11\":\"2\",\"_rn_\":\"Merc 230\"},{\"1\":\"19.2\",\"2\":\"6\",\"3\":\"167.6\",\"4\":\"123\",\"5\":\"3.92\",\"6\":\"3.440\",\"7\":\"18.30\",\"8\":\"1\",\"9\":\"0\",\"10\":\"4\",\"11\":\"4\",\"_rn_\":\"Merc 280\"},{\"1\":\"17.8\",\"2\":\"6\",\"3\":\"167.6\",\"4\":\"123\",\"5\":\"3.92\",\"6\":\"3.440\",\"7\":\"18.90\",\"8\":\"1\",\"9\":\"0\",\"10\":\"4\",\"11\":\"4\",\"_rn_\":\"Merc 280C\"},{\"1\":\"16.4\",\"2\":\"8\",\"3\":\"275.8\",\"4\":\"180\",\"5\":\"3.07\",\"6\":\"4.070\",\"7\":\"17.40\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"3\",\"_rn_\":\"Merc 450SE\"},{\"1\":\"17.3\",\"2\":\"8\",\"3\":\"275.8\",\"4\":\"180\",\"5\":\"3.07\",\"6\":\"3.730\",\"7\":\"17.60\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"3\",\"_rn_\":\"Merc 450SL\"},{\"1\":\"15.2\",\"2\":\"8\",\"3\":\"275.8\",\"4\":\"180\",\"5\":\"3.07\",\"6\":\"3.780\",\"7\":\"18.00\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"3\",\"_rn_\":\"Merc 450SLC\"},{\"1\":\"10.4\",\"2\":\"8\",\"3\":\"472.0\",\"4\":\"205\",\"5\":\"2.93\",\"6\":\"5.250\",\"7\":\"17.98\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"4\",\"_rn_\":\"Cadillac Fleetwood\"},{\"1\":\"10.4\",\"2\":\"8\",\"3\":\"460.0\",\"4\":\"215\",\"5\":\"3.00\",\"6\":\"5.424\",\"7\":\"17.82\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"4\",\"_rn_\":\"Lincoln Continental\"},{\"1\":\"14.7\",\"2\":\"8\",\"3\":\"440.0\",\"4\":\"230\",\"5\":\"3.23\",\"6\":\"5.345\",\"7\":\"17.42\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"4\",\"_rn_\":\"Chrysler Imperial\"},{\"1\":\"32.4\",\"2\":\"4\",\"3\":\"78.7\",\"4\":\"66\",\"5\":\"4.08\",\"6\":\"2.200\",\"7\":\"19.47\",\"8\":\"1\",\"9\":\"1\",\"10\":\"4\",\"11\":\"1\",\"_rn_\":\"Fiat 128\"},{\"1\":\"30.4\",\"2\":\"4\",\"3\":\"75.7\",\"4\":\"52\",\"5\":\"4.93\",\"6\":\"1.615\",\"7\":\"18.52\",\"8\":\"1\",\"9\":\"1\",\"10\":\"4\",\"11\":\"2\",\"_rn_\":\"Honda Civic\"},{\"1\":\"33.9\",\"2\":\"4\",\"3\":\"71.1\",\"4\":\"65\",\"5\":\"4.22\",\"6\":\"1.835\",\"7\":\"19.90\",\"8\":\"1\",\"9\":\"1\",\"10\":\"4\",\"11\":\"1\",\"_rn_\":\"Toyota Corolla\"},{\"1\":\"21.5\",\"2\":\"4\",\"3\":\"120.1\",\"4\":\"97\",\"5\":\"3.70\",\"6\":\"2.465\",\"7\":\"20.01\",\"8\":\"1\",\"9\":\"0\",\"10\":\"3\",\"11\":\"1\",\"_rn_\":\"Toyota Corona\"},{\"1\":\"15.5\",\"2\":\"8\",\"3\":\"318.0\",\"4\":\"150\",\"5\":\"2.76\",\"6\":\"3.520\",\"7\":\"16.87\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"2\",\"_rn_\":\"Dodge Challenger\"},{\"1\":\"15.2\",\"2\":\"8\",\"3\":\"304.0\",\"4\":\"150\",\"5\":\"3.15\",\"6\":\"3.435\",\"7\":\"17.30\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"2\",\"_rn_\":\"AMC Javelin\"},{\"1\":\"13.3\",\"2\":\"8\",\"3\":\"350.0\",\"4\":\"245\",\"5\":\"3.73\",\"6\":\"3.840\",\"7\":\"15.41\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"4\",\"_rn_\":\"Camaro Z28\"},{\"1\":\"19.2\",\"2\":\"8\",\"3\":\"400.0\",\"4\":\"175\",\"5\":\"3.08\",\"6\":\"3.845\",\"7\":\"17.05\",\"8\":\"0\",\"9\":\"0\",\"10\":\"3\",\"11\":\"2\",\"_rn_\":\"Pontiac Firebird\"},{\"1\":\"27.3\",\"2\":\"4\",\"3\":\"79.0\",\"4\":\"66\",\"5\":\"4.08\",\"6\":\"1.935\",\"7\":\"18.90\",\"8\":\"1\",\"9\":\"1\",\"10\":\"4\",\"11\":\"1\",\"_rn_\":\"Fiat X1-9\"},{\"1\":\"26.0\",\"2\":\"4\",\"3\":\"120.3\",\"4\":\"91\",\"5\":\"4.43\",\"6\":\"2.140\",\"7\":\"16.70\",\"8\":\"0\",\"9\":\"1\",\"10\":\"5\",\"11\":\"2\",\"_rn_\":\"Porsche 914-2\"},{\"1\":\"30.4\",\"2\":\"4\",\"3\":\"95.1\",\"4\":\"113\",\"5\":\"3.77\",\"6\":\"1.513\",\"7\":\"16.90\",\"8\":\"1\",\"9\":\"1\",\"10\":\"5\",\"11\":\"2\",\"_rn_\":\"Lotus Europa\"},{\"1\":\"15.8\",\"2\":\"8\",\"3\":\"351.0\",\"4\":\"264\",\"5\":\"4.22\",\"6\":\"3.170\",\"7\":\"14.50\",\"8\":\"0\",\"9\":\"1\",\"10\":\"5\",\"11\":\"4\",\"_rn_\":\"Ford Pantera L\"},{\"1\":\"19.7\",\"2\":\"6\",\"3\":\"145.0\",\"4\":\"175\",\"5\":\"3.62\",\"6\":\"2.770\",\"7\":\"15.50\",\"8\":\"0\",\"9\":\"1\",\"10\":\"5\",\"11\":\"6\",\"_rn_\":\"Ferrari Dino\"},{\"1\":\"15.0\",\"2\":\"8\",\"3\":\"301.0\",\"4\":\"335\",\"5\":\"3.54\",\"6\":\"3.570\",\"7\":\"14.60\",\"8\":\"0\",\"9\":\"1\",\"10\":\"5\",\"11\":\"8\",\"_rn_\":\"Maserati Bora\"},{\"1\":\"21.4\",\"2\":\"4\",\"3\":\"121.0\",\"4\":\"109\",\"5\":\"4.11\",\"6\":\"2.780\",\"7\":\"18.60\",\"8\":\"1\",\"9\":\"1\",\"10\":\"4\",\"11\":\"2\",\"_rn_\":\"Volvo 142E\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nBelow a standard static plot of 'mpg' (miles per US gallon) variable by 'cyl' (number of cylinders) variable, built with `ggplot2` . First we apply a custom theme.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Custom theme\"}\nggplot2::theme_update(\n  axis.text = element_text(size = 11),\n  legend.background = element_blank(),\n  panel.background = element_rect(fill = \"grey85\"),\n  panel.border = element_rect(colour = \"black\", fill = NA),\n  panel.grid = element_line(colour = \"whitesmoke\"),\n  panel.grid.minor.y = element_blank(),\n  panel.grid.minor.x = element_blank(),\n  plot.title = element_text(hjust = 0.5),\n  plot.subtitle = element_text(face = \"italic\", hjust = 0.5),\n  strip.background = element_rect(colour = \"black\", fill = \"grey85\"),\n  strip.text = element_text(size = 10, face = \"bold\"),\n  title = element_text(size = 12, face = \"bold\")\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nh <- ggplot(mtcars, aes(y = as.factor(cyl), x = mpg)) +\n  geom_boxplot(aes(fill = as.factor(cyl)), show.legend = F) +\n  scale_x_continuous(limits = c(10, 35), breaks = seq(10,35,2.5)) +\n  labs(title = \"Miles per gallon (mpg) by num. of cylinders (cyl)\", y = \"cyl\")\nh\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=100% height=250%}\n:::\n:::\n\n\nNow let's say we want to see how the transmission type ('am' variable) influences the miles per gallon for each amount of cylinders. We can add an animation based on 'am' variable, which is categorical/binary (0 for automatic transmission, and 1 for manual transmission) with `gganimate::transition_states()` . This transition splits your data into multiple states based on the levels in a given column. We add the transition by simply adding a new layer to our plot, like we do in base `ggplot2` .\n\n\n::: {.cell}\n\n```{.r .cell-code}\nh_anim <- h +\n  transition_states(states = as.factor(am), transition_length = 2, state_length = 1) +\n  ease_aes(\"cubic-in-out\") +\n  labs(subtitle = \"Transmission, am = {closest_state}\")\nh_anim\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.gif){width=100% height=250%}\n:::\n:::\n\n\nAs you can see, the manual transmission ('am' = 1) is associated with a lower fuel consumption, on average, for each amount of cylinders.\n\nWith `transition_length` parameter we set the relative length of the transition between different states, while the relative length of the pause at each state is defined by `state_length` parameter. For a better animation, the easing modifier in `ease_aes()` was set to \"in-out\" for a slower start and end of each transition. Finally, a subtitle with `glue` syntax was added, so that the label changes whenever there's a state transition. For a list of the available label variables for `transition_states()` function, see its documentation with `?gganimate::transition_states` .\n\n::: callout-caution\n## Caution:\n\nThe glue syntax is automatically detected only when used inside `ggplot2` labels functions (for example `ggtitle()` , `labs()` , etc.\n:::\n\nWe can also change the rendering parameters with `animate()` function. For example, below we set the number of frames to 200 (default = 100) for a smoother animation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nh_anim |> animate(nframes = 200)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.gif){width=100% height=250%}\n:::\n:::\n\n:::\n\n# Example 2: iris dataset\n\n::: justify\nNow we'll build an additional visualization on `iris` R prebuilt dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatasets::iris\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Sepal.Length\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Sepal.Width\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Petal.Length\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Petal.Width\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Species\"],\"name\":[5],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"5.1\",\"2\":\"3.5\",\"3\":\"1.4\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.9\",\"2\":\"3.0\",\"3\":\"1.4\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.7\",\"2\":\"3.2\",\"3\":\"1.3\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.6\",\"2\":\"3.1\",\"3\":\"1.5\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.0\",\"2\":\"3.6\",\"3\":\"1.4\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.4\",\"2\":\"3.9\",\"3\":\"1.7\",\"4\":\"0.4\",\"5\":\"setosa\"},{\"1\":\"4.6\",\"2\":\"3.4\",\"3\":\"1.4\",\"4\":\"0.3\",\"5\":\"setosa\"},{\"1\":\"5.0\",\"2\":\"3.4\",\"3\":\"1.5\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.4\",\"2\":\"2.9\",\"3\":\"1.4\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.9\",\"2\":\"3.1\",\"3\":\"1.5\",\"4\":\"0.1\",\"5\":\"setosa\"},{\"1\":\"5.4\",\"2\":\"3.7\",\"3\":\"1.5\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.8\",\"2\":\"3.4\",\"3\":\"1.6\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.8\",\"2\":\"3.0\",\"3\":\"1.4\",\"4\":\"0.1\",\"5\":\"setosa\"},{\"1\":\"4.3\",\"2\":\"3.0\",\"3\":\"1.1\",\"4\":\"0.1\",\"5\":\"setosa\"},{\"1\":\"5.8\",\"2\":\"4.0\",\"3\":\"1.2\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.7\",\"2\":\"4.4\",\"3\":\"1.5\",\"4\":\"0.4\",\"5\":\"setosa\"},{\"1\":\"5.4\",\"2\":\"3.9\",\"3\":\"1.3\",\"4\":\"0.4\",\"5\":\"setosa\"},{\"1\":\"5.1\",\"2\":\"3.5\",\"3\":\"1.4\",\"4\":\"0.3\",\"5\":\"setosa\"},{\"1\":\"5.7\",\"2\":\"3.8\",\"3\":\"1.7\",\"4\":\"0.3\",\"5\":\"setosa\"},{\"1\":\"5.1\",\"2\":\"3.8\",\"3\":\"1.5\",\"4\":\"0.3\",\"5\":\"setosa\"},{\"1\":\"5.4\",\"2\":\"3.4\",\"3\":\"1.7\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.1\",\"2\":\"3.7\",\"3\":\"1.5\",\"4\":\"0.4\",\"5\":\"setosa\"},{\"1\":\"4.6\",\"2\":\"3.6\",\"3\":\"1.0\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.1\",\"2\":\"3.3\",\"3\":\"1.7\",\"4\":\"0.5\",\"5\":\"setosa\"},{\"1\":\"4.8\",\"2\":\"3.4\",\"3\":\"1.9\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.0\",\"2\":\"3.0\",\"3\":\"1.6\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.0\",\"2\":\"3.4\",\"3\":\"1.6\",\"4\":\"0.4\",\"5\":\"setosa\"},{\"1\":\"5.2\",\"2\":\"3.5\",\"3\":\"1.5\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.2\",\"2\":\"3.4\",\"3\":\"1.4\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.7\",\"2\":\"3.2\",\"3\":\"1.6\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.8\",\"2\":\"3.1\",\"3\":\"1.6\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.4\",\"2\":\"3.4\",\"3\":\"1.5\",\"4\":\"0.4\",\"5\":\"setosa\"},{\"1\":\"5.2\",\"2\":\"4.1\",\"3\":\"1.5\",\"4\":\"0.1\",\"5\":\"setosa\"},{\"1\":\"5.5\",\"2\":\"4.2\",\"3\":\"1.4\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.9\",\"2\":\"3.1\",\"3\":\"1.5\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.0\",\"2\":\"3.2\",\"3\":\"1.2\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.5\",\"2\":\"3.5\",\"3\":\"1.3\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.9\",\"2\":\"3.6\",\"3\":\"1.4\",\"4\":\"0.1\",\"5\":\"setosa\"},{\"1\":\"4.4\",\"2\":\"3.0\",\"3\":\"1.3\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.1\",\"2\":\"3.4\",\"3\":\"1.5\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.0\",\"2\":\"3.5\",\"3\":\"1.3\",\"4\":\"0.3\",\"5\":\"setosa\"},{\"1\":\"4.5\",\"2\":\"2.3\",\"3\":\"1.3\",\"4\":\"0.3\",\"5\":\"setosa\"},{\"1\":\"4.4\",\"2\":\"3.2\",\"3\":\"1.3\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.0\",\"2\":\"3.5\",\"3\":\"1.6\",\"4\":\"0.6\",\"5\":\"setosa\"},{\"1\":\"5.1\",\"2\":\"3.8\",\"3\":\"1.9\",\"4\":\"0.4\",\"5\":\"setosa\"},{\"1\":\"4.8\",\"2\":\"3.0\",\"3\":\"1.4\",\"4\":\"0.3\",\"5\":\"setosa\"},{\"1\":\"5.1\",\"2\":\"3.8\",\"3\":\"1.6\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"4.6\",\"2\":\"3.2\",\"3\":\"1.4\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.3\",\"2\":\"3.7\",\"3\":\"1.5\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"5.0\",\"2\":\"3.3\",\"3\":\"1.4\",\"4\":\"0.2\",\"5\":\"setosa\"},{\"1\":\"7.0\",\"2\":\"3.2\",\"3\":\"4.7\",\"4\":\"1.4\",\"5\":\"versicolor\"},{\"1\":\"6.4\",\"2\":\"3.2\",\"3\":\"4.5\",\"4\":\"1.5\",\"5\":\"versicolor\"},{\"1\":\"6.9\",\"2\":\"3.1\",\"3\":\"4.9\",\"4\":\"1.5\",\"5\":\"versicolor\"},{\"1\":\"5.5\",\"2\":\"2.3\",\"3\":\"4.0\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"6.5\",\"2\":\"2.8\",\"3\":\"4.6\",\"4\":\"1.5\",\"5\":\"versicolor\"},{\"1\":\"5.7\",\"2\":\"2.8\",\"3\":\"4.5\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"6.3\",\"2\":\"3.3\",\"3\":\"4.7\",\"4\":\"1.6\",\"5\":\"versicolor\"},{\"1\":\"4.9\",\"2\":\"2.4\",\"3\":\"3.3\",\"4\":\"1.0\",\"5\":\"versicolor\"},{\"1\":\"6.6\",\"2\":\"2.9\",\"3\":\"4.6\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"5.2\",\"2\":\"2.7\",\"3\":\"3.9\",\"4\":\"1.4\",\"5\":\"versicolor\"},{\"1\":\"5.0\",\"2\":\"2.0\",\"3\":\"3.5\",\"4\":\"1.0\",\"5\":\"versicolor\"},{\"1\":\"5.9\",\"2\":\"3.0\",\"3\":\"4.2\",\"4\":\"1.5\",\"5\":\"versicolor\"},{\"1\":\"6.0\",\"2\":\"2.2\",\"3\":\"4.0\",\"4\":\"1.0\",\"5\":\"versicolor\"},{\"1\":\"6.1\",\"2\":\"2.9\",\"3\":\"4.7\",\"4\":\"1.4\",\"5\":\"versicolor\"},{\"1\":\"5.6\",\"2\":\"2.9\",\"3\":\"3.6\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"6.7\",\"2\":\"3.1\",\"3\":\"4.4\",\"4\":\"1.4\",\"5\":\"versicolor\"},{\"1\":\"5.6\",\"2\":\"3.0\",\"3\":\"4.5\",\"4\":\"1.5\",\"5\":\"versicolor\"},{\"1\":\"5.8\",\"2\":\"2.7\",\"3\":\"4.1\",\"4\":\"1.0\",\"5\":\"versicolor\"},{\"1\":\"6.2\",\"2\":\"2.2\",\"3\":\"4.5\",\"4\":\"1.5\",\"5\":\"versicolor\"},{\"1\":\"5.6\",\"2\":\"2.5\",\"3\":\"3.9\",\"4\":\"1.1\",\"5\":\"versicolor\"},{\"1\":\"5.9\",\"2\":\"3.2\",\"3\":\"4.8\",\"4\":\"1.8\",\"5\":\"versicolor\"},{\"1\":\"6.1\",\"2\":\"2.8\",\"3\":\"4.0\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"6.3\",\"2\":\"2.5\",\"3\":\"4.9\",\"4\":\"1.5\",\"5\":\"versicolor\"},{\"1\":\"6.1\",\"2\":\"2.8\",\"3\":\"4.7\",\"4\":\"1.2\",\"5\":\"versicolor\"},{\"1\":\"6.4\",\"2\":\"2.9\",\"3\":\"4.3\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"6.6\",\"2\":\"3.0\",\"3\":\"4.4\",\"4\":\"1.4\",\"5\":\"versicolor\"},{\"1\":\"6.8\",\"2\":\"2.8\",\"3\":\"4.8\",\"4\":\"1.4\",\"5\":\"versicolor\"},{\"1\":\"6.7\",\"2\":\"3.0\",\"3\":\"5.0\",\"4\":\"1.7\",\"5\":\"versicolor\"},{\"1\":\"6.0\",\"2\":\"2.9\",\"3\":\"4.5\",\"4\":\"1.5\",\"5\":\"versicolor\"},{\"1\":\"5.7\",\"2\":\"2.6\",\"3\":\"3.5\",\"4\":\"1.0\",\"5\":\"versicolor\"},{\"1\":\"5.5\",\"2\":\"2.4\",\"3\":\"3.8\",\"4\":\"1.1\",\"5\":\"versicolor\"},{\"1\":\"5.5\",\"2\":\"2.4\",\"3\":\"3.7\",\"4\":\"1.0\",\"5\":\"versicolor\"},{\"1\":\"5.8\",\"2\":\"2.7\",\"3\":\"3.9\",\"4\":\"1.2\",\"5\":\"versicolor\"},{\"1\":\"6.0\",\"2\":\"2.7\",\"3\":\"5.1\",\"4\":\"1.6\",\"5\":\"versicolor\"},{\"1\":\"5.4\",\"2\":\"3.0\",\"3\":\"4.5\",\"4\":\"1.5\",\"5\":\"versicolor\"},{\"1\":\"6.0\",\"2\":\"3.4\",\"3\":\"4.5\",\"4\":\"1.6\",\"5\":\"versicolor\"},{\"1\":\"6.7\",\"2\":\"3.1\",\"3\":\"4.7\",\"4\":\"1.5\",\"5\":\"versicolor\"},{\"1\":\"6.3\",\"2\":\"2.3\",\"3\":\"4.4\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"5.6\",\"2\":\"3.0\",\"3\":\"4.1\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"5.5\",\"2\":\"2.5\",\"3\":\"4.0\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"5.5\",\"2\":\"2.6\",\"3\":\"4.4\",\"4\":\"1.2\",\"5\":\"versicolor\"},{\"1\":\"6.1\",\"2\":\"3.0\",\"3\":\"4.6\",\"4\":\"1.4\",\"5\":\"versicolor\"},{\"1\":\"5.8\",\"2\":\"2.6\",\"3\":\"4.0\",\"4\":\"1.2\",\"5\":\"versicolor\"},{\"1\":\"5.0\",\"2\":\"2.3\",\"3\":\"3.3\",\"4\":\"1.0\",\"5\":\"versicolor\"},{\"1\":\"5.6\",\"2\":\"2.7\",\"3\":\"4.2\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"5.7\",\"2\":\"3.0\",\"3\":\"4.2\",\"4\":\"1.2\",\"5\":\"versicolor\"},{\"1\":\"5.7\",\"2\":\"2.9\",\"3\":\"4.2\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"6.2\",\"2\":\"2.9\",\"3\":\"4.3\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"5.1\",\"2\":\"2.5\",\"3\":\"3.0\",\"4\":\"1.1\",\"5\":\"versicolor\"},{\"1\":\"5.7\",\"2\":\"2.8\",\"3\":\"4.1\",\"4\":\"1.3\",\"5\":\"versicolor\"},{\"1\":\"6.3\",\"2\":\"3.3\",\"3\":\"6.0\",\"4\":\"2.5\",\"5\":\"virginica\"},{\"1\":\"5.8\",\"2\":\"2.7\",\"3\":\"5.1\",\"4\":\"1.9\",\"5\":\"virginica\"},{\"1\":\"7.1\",\"2\":\"3.0\",\"3\":\"5.9\",\"4\":\"2.1\",\"5\":\"virginica\"},{\"1\":\"6.3\",\"2\":\"2.9\",\"3\":\"5.6\",\"4\":\"1.8\",\"5\":\"virginica\"},{\"1\":\"6.5\",\"2\":\"3.0\",\"3\":\"5.8\",\"4\":\"2.2\",\"5\":\"virginica\"},{\"1\":\"7.6\",\"2\":\"3.0\",\"3\":\"6.6\",\"4\":\"2.1\",\"5\":\"virginica\"},{\"1\":\"4.9\",\"2\":\"2.5\",\"3\":\"4.5\",\"4\":\"1.7\",\"5\":\"virginica\"},{\"1\":\"7.3\",\"2\":\"2.9\",\"3\":\"6.3\",\"4\":\"1.8\",\"5\":\"virginica\"},{\"1\":\"6.7\",\"2\":\"2.5\",\"3\":\"5.8\",\"4\":\"1.8\",\"5\":\"virginica\"},{\"1\":\"7.2\",\"2\":\"3.6\",\"3\":\"6.1\",\"4\":\"2.5\",\"5\":\"virginica\"},{\"1\":\"6.5\",\"2\":\"3.2\",\"3\":\"5.1\",\"4\":\"2.0\",\"5\":\"virginica\"},{\"1\":\"6.4\",\"2\":\"2.7\",\"3\":\"5.3\",\"4\":\"1.9\",\"5\":\"virginica\"},{\"1\":\"6.8\",\"2\":\"3.0\",\"3\":\"5.5\",\"4\":\"2.1\",\"5\":\"virginica\"},{\"1\":\"5.7\",\"2\":\"2.5\",\"3\":\"5.0\",\"4\":\"2.0\",\"5\":\"virginica\"},{\"1\":\"5.8\",\"2\":\"2.8\",\"3\":\"5.1\",\"4\":\"2.4\",\"5\":\"virginica\"},{\"1\":\"6.4\",\"2\":\"3.2\",\"3\":\"5.3\",\"4\":\"2.3\",\"5\":\"virginica\"},{\"1\":\"6.5\",\"2\":\"3.0\",\"3\":\"5.5\",\"4\":\"1.8\",\"5\":\"virginica\"},{\"1\":\"7.7\",\"2\":\"3.8\",\"3\":\"6.7\",\"4\":\"2.2\",\"5\":\"virginica\"},{\"1\":\"7.7\",\"2\":\"2.6\",\"3\":\"6.9\",\"4\":\"2.3\",\"5\":\"virginica\"},{\"1\":\"6.0\",\"2\":\"2.2\",\"3\":\"5.0\",\"4\":\"1.5\",\"5\":\"virginica\"},{\"1\":\"6.9\",\"2\":\"3.2\",\"3\":\"5.7\",\"4\":\"2.3\",\"5\":\"virginica\"},{\"1\":\"5.6\",\"2\":\"2.8\",\"3\":\"4.9\",\"4\":\"2.0\",\"5\":\"virginica\"},{\"1\":\"7.7\",\"2\":\"2.8\",\"3\":\"6.7\",\"4\":\"2.0\",\"5\":\"virginica\"},{\"1\":\"6.3\",\"2\":\"2.7\",\"3\":\"4.9\",\"4\":\"1.8\",\"5\":\"virginica\"},{\"1\":\"6.7\",\"2\":\"3.3\",\"3\":\"5.7\",\"4\":\"2.1\",\"5\":\"virginica\"},{\"1\":\"7.2\",\"2\":\"3.2\",\"3\":\"6.0\",\"4\":\"1.8\",\"5\":\"virginica\"},{\"1\":\"6.2\",\"2\":\"2.8\",\"3\":\"4.8\",\"4\":\"1.8\",\"5\":\"virginica\"},{\"1\":\"6.1\",\"2\":\"3.0\",\"3\":\"4.9\",\"4\":\"1.8\",\"5\":\"virginica\"},{\"1\":\"6.4\",\"2\":\"2.8\",\"3\":\"5.6\",\"4\":\"2.1\",\"5\":\"virginica\"},{\"1\":\"7.2\",\"2\":\"3.0\",\"3\":\"5.8\",\"4\":\"1.6\",\"5\":\"virginica\"},{\"1\":\"7.4\",\"2\":\"2.8\",\"3\":\"6.1\",\"4\":\"1.9\",\"5\":\"virginica\"},{\"1\":\"7.9\",\"2\":\"3.8\",\"3\":\"6.4\",\"4\":\"2.0\",\"5\":\"virginica\"},{\"1\":\"6.4\",\"2\":\"2.8\",\"3\":\"5.6\",\"4\":\"2.2\",\"5\":\"virginica\"},{\"1\":\"6.3\",\"2\":\"2.8\",\"3\":\"5.1\",\"4\":\"1.5\",\"5\":\"virginica\"},{\"1\":\"6.1\",\"2\":\"2.6\",\"3\":\"5.6\",\"4\":\"1.4\",\"5\":\"virginica\"},{\"1\":\"7.7\",\"2\":\"3.0\",\"3\":\"6.1\",\"4\":\"2.3\",\"5\":\"virginica\"},{\"1\":\"6.3\",\"2\":\"3.4\",\"3\":\"5.6\",\"4\":\"2.4\",\"5\":\"virginica\"},{\"1\":\"6.4\",\"2\":\"3.1\",\"3\":\"5.5\",\"4\":\"1.8\",\"5\":\"virginica\"},{\"1\":\"6.0\",\"2\":\"3.0\",\"3\":\"4.8\",\"4\":\"1.8\",\"5\":\"virginica\"},{\"1\":\"6.9\",\"2\":\"3.1\",\"3\":\"5.4\",\"4\":\"2.1\",\"5\":\"virginica\"},{\"1\":\"6.7\",\"2\":\"3.1\",\"3\":\"5.6\",\"4\":\"2.4\",\"5\":\"virginica\"},{\"1\":\"6.9\",\"2\":\"3.1\",\"3\":\"5.1\",\"4\":\"2.3\",\"5\":\"virginica\"},{\"1\":\"5.8\",\"2\":\"2.7\",\"3\":\"5.1\",\"4\":\"1.9\",\"5\":\"virginica\"},{\"1\":\"6.8\",\"2\":\"3.2\",\"3\":\"5.9\",\"4\":\"2.3\",\"5\":\"virginica\"},{\"1\":\"6.7\",\"2\":\"3.3\",\"3\":\"5.7\",\"4\":\"2.5\",\"5\":\"virginica\"},{\"1\":\"6.7\",\"2\":\"3.0\",\"3\":\"5.2\",\"4\":\"2.3\",\"5\":\"virginica\"},{\"1\":\"6.3\",\"2\":\"2.5\",\"3\":\"5.0\",\"4\":\"1.9\",\"5\":\"virginica\"},{\"1\":\"6.5\",\"2\":\"3.0\",\"3\":\"5.2\",\"4\":\"2.0\",\"5\":\"virginica\"},{\"1\":\"6.2\",\"2\":\"3.4\",\"3\":\"5.4\",\"4\":\"2.3\",\"5\":\"virginica\"},{\"1\":\"5.9\",\"2\":\"3.0\",\"3\":\"5.1\",\"4\":\"1.8\",\"5\":\"virginica\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nLet's say we want to see what iris species have the longest and largest petals. We can draw a simple scatterplot to find out the \"biggest\" species.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ns <- ggplot(iris, aes(x = Petal.Width, y = Petal.Length)) +\n  geom_point(aes(colour = Species)) +\n  labs(title = \"Petal.length vs Petal.Width\")\ns\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=100% height=250%}\n:::\n:::\n\n\nNow, this particular plot is clear and straightforward, and already fine as it is. Each species takes a specific area in the plot, and there's almost no overlapping of data points. However, overlapping is a very common problem of scatter plots, especially when there are many data points, and creating an animation with different states can solve it, so let's animate our iris plot.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ns_anim <- s +\n  transition_states(Species, transition_length = 2) +\n  ease_aes(\"quadratic-in-out\") +\n  enter_fade() +\n  exit_shrink() +\n  labs(subtitle = \"Species = {closest_state}\") +\n  theme(legend.position = \"none\")\ns_anim\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.gif){width=100% height=250%}\n:::\n:::\n\n\nThis time, custom enter and exit behaviours were set. In `iris` dataset, each row represents a different individual, there aren't multiple observations of the same individual, so we don't want the data points to move across the plot (default behaviour). If that was the case, it would appear as if data in a single measurement changes gradually as the flower being measured on somehow morphs between three different iris species, which obviously doesn't make sense. To avoid this problem, an `exit_shrink()` call was added, so that the data points shrink in size and disappear when there's a transition between states, rather than moving. Here, `enter_fade()` is just an aesthetic improvement (the data points start at max transparency and end up with the transparency level you set when building the plot; no transparency in this case).\n:::\n\n# Example 3: USPersonalExpenditure dataset\n\n::: justify\nAs final example, we'll build an animation on a custom long version of `USPersonalExpenditure` R prebuilt dataset.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlong_USPE <- function() {\n  df <- datasets::USPersonalExpenditure |> as.data.frame()\n  df$category <- rownames(df)\n  df <- reshape2::melt(df, \"category\")\n  df$variable <- ordered(df$variable)\n  names(df) <- c(\"category\", \"year\", \"expenditure\")\n  return(df)\n}\nlong_USPE()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"category\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"year\"],\"name\":[2],\"type\":[\"ord\"],\"align\":[\"right\"]},{\"label\":[\"expenditure\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Food and Tobacco\",\"2\":\"1940\",\"3\":\"22.200\"},{\"1\":\"Household Operation\",\"2\":\"1940\",\"3\":\"10.500\"},{\"1\":\"Medical and Health\",\"2\":\"1940\",\"3\":\"3.530\"},{\"1\":\"Personal Care\",\"2\":\"1940\",\"3\":\"1.040\"},{\"1\":\"Private Education\",\"2\":\"1940\",\"3\":\"0.341\"},{\"1\":\"Food and Tobacco\",\"2\":\"1945\",\"3\":\"44.500\"},{\"1\":\"Household Operation\",\"2\":\"1945\",\"3\":\"15.500\"},{\"1\":\"Medical and Health\",\"2\":\"1945\",\"3\":\"5.760\"},{\"1\":\"Personal Care\",\"2\":\"1945\",\"3\":\"1.980\"},{\"1\":\"Private Education\",\"2\":\"1945\",\"3\":\"0.974\"},{\"1\":\"Food and Tobacco\",\"2\":\"1950\",\"3\":\"59.600\"},{\"1\":\"Household Operation\",\"2\":\"1950\",\"3\":\"29.000\"},{\"1\":\"Medical and Health\",\"2\":\"1950\",\"3\":\"9.710\"},{\"1\":\"Personal Care\",\"2\":\"1950\",\"3\":\"2.450\"},{\"1\":\"Private Education\",\"2\":\"1950\",\"3\":\"1.800\"},{\"1\":\"Food and Tobacco\",\"2\":\"1955\",\"3\":\"73.200\"},{\"1\":\"Household Operation\",\"2\":\"1955\",\"3\":\"36.500\"},{\"1\":\"Medical and Health\",\"2\":\"1955\",\"3\":\"14.000\"},{\"1\":\"Personal Care\",\"2\":\"1955\",\"3\":\"3.400\"},{\"1\":\"Private Education\",\"2\":\"1955\",\"3\":\"2.600\"},{\"1\":\"Food and Tobacco\",\"2\":\"1960\",\"3\":\"86.800\"},{\"1\":\"Household Operation\",\"2\":\"1960\",\"3\":\"46.200\"},{\"1\":\"Medical and Health\",\"2\":\"1960\",\"3\":\"21.100\"},{\"1\":\"Personal Care\",\"2\":\"1960\",\"3\":\"5.400\"},{\"1\":\"Private Education\",\"2\":\"1960\",\"3\":\"3.640\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nFirst, we build a static visualization.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nl <- ggplot(long_USPE(), aes(x = year, y = expenditure, group = category, colour = category)) +\n  geom_line() +\n  geom_point() +\n  labs(title = \"US personal expenditures\", y = \"Expenditure (billions $)\", x = \"Year\")\nl\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=100% height=250%}\n:::\n:::\n\n\nThe line plot here is already fine, and is a good representation of the increasing trends of personal expenditures from 1940 to 1960, but we can make it more visually appealing by adding a `transition_reveal()` call, which allows the data to gradually appear, along a given time dimension.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nl_anim <- l +\n  geom_text(aes(label = expenditure |> round(2) |> format(nsmall = 2)), fontface = \"bold\", parse = T, \n            check_overlap = T, nudge_x = .2, nudge_y = 1) +\n  transition_reveal(as.numeric(year)) +\n  ease_aes(\"quadratic-in-out\") +\n  theme(legend.position = c(0.15,0.8), legend.title = element_blank())\nl_anim\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.gif){width=100% height=250%}\n:::\n:::\n\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}